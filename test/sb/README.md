# **ТЕСТИРОВАНИЕ**
*Результаты можно зафиксировать в одном эксель файле на разных листах, соответствующих номеру задания.*
## **Часть №1. Выгрузка и обработка данных**
Исходные данные: имеются 3 таблицы.

**CLIENTS**
|CLIENT\_ID|NAME|
|---|---|
|1|Иванов|
|2|Петров|
|3|Сидоров|

**CONTRACTS**
|CONTRACT\_ID|CLIENT\_ID|CONTRACT\_NUM|
|---|---|---|
|1|1|1589/78|
|2|1|2016/987|
|3|1|3005/154|
|4|2|45/78962|
|5|2|589/54|
|6|3|678/45|

**OPERATION**
|OP\_ID|CONTRACT\_ID|DATE|SUMMA|
|---|---|---|---|
|1|1|01.06.2022|800|
|2|1|01.07.2022|50|
|3|2|23.03.2022|300|
|4|4|15.08.2022|900|
|5|4|01.02.2022|1000|
|6|5|09.03.2022|200|
|7|6|15.08.2022|700|

1) Напишите запрос, который выведет всех клиентов с максимальной датой сделки. В ответе ожидается код и полученная таблица.
1) Напишите запрос, показывающий, какую сумму за все время погасил каждый клиент. В ответе ожидается код и полученная таблица.


## **Часть №2. Аналитика**

1) Исходные данные – показана понедельная структура отказов по заявкам клиентов (таблица ниже). Каждый отказ относится к одному блоку проверки. При этом кредитная история клиента проверяется в двух равнозначных бюро кредитных историй (равнозначные - структура отказов у них одинаковая, но состав кредитных счетов разный по клиентам).

Задание:

1. Как вы понимаете, что такое кредитный скоринг (краткая формулировка своими словами)?
1. Почему может не рассчитаться сумма кредита по клиенту (краткое описание возможных причин на ваш взгляд)?
1. Нарисуйте схематично, на ваш взгляд, используя указанную структуру отказов,  последовательность блоков проверки (4 блока) и их соединение (последовательное или параллельное; с выходом с маршрута после отказа на блоке или продолжаем проверку, даже получив отказ на предыдущем блоке).
   Опишите кратко, почему составили схему именно так.
1. Какой вывод относительно работоспособности блоков проверки вы можете сделать?

|**Блоки**|**Причина отказа**|**Неделя 1**|**Неделя 2**|**Неделя 3**|**Неделя 4**|
| :-: | :-: | :-: | :-: | :-: | :-: |
||Негативная кредитная история клиента|40,1%|39,8%|35,0%|40,0%|
|Бюро 1|*в т.ч. Бюро 1*|*4,6%*|*3,5%*|*0%*|*4,1%*|
|Бюро 2|*в т.ч. Бюро 2*|*35,5%*|*36,3%*|*35,0%*|*35,9%*|
|Лимит|Не рассчитывается сумма кредита |30,2%|31,0%|34,0%|30,1%|
|Скоринг|Непроходной скоринг|29,7%|29,2%|31,0%|29,9%|
||**Итого**|**100,0%**|**100,0%**|**100,0%**|**100,0%**|

1) Исходные данные – в файле «Файл 2.xlsx» выгрузка по заявкам клиентов с причинами отказа и параметрами клиентов.

Задание (*ответы на вопросы можно дополнить визуализацией (график, диаграмма, таблица и т.п*.):

1. Как распределяет поток клиентов по каналам оформления заявки?
1. Какие клиенты в основном заводят заявки в партнерском канале, можно ли выделить «портрет основного клиента»?
1. Играет ли роль возраст клиента в зависимости от канала оформления заявки?
1. Какой из каналов генерирует меньше всех положительных заявок?
1. Какая самая популярная причина отказа по заявкам?
1. Можете выделить еще какие-то интересные факты по выгрузке (необязательно)?

## **Часть №3. Задание повышенной сложности**
Необходимо распарсить .xml файлы, содержащие в себе кредитные отчеты: 1.xml, 2.xml, 3.xml.
Результатом должна быть плоская таблица (выгрузка в эксель), содержащая данные  из каждого отчета из блока LOANS: 
OPEN\_DATE; RELATIONSHIP; FINAL\_PMT\_DATE; TYPE; PMT\_STRING\_84M; STATUS; OUTSTANDING; INF\_CONFIRM\_DATE; CREDIT\_LIMIT; DELQ\_BALANCE; IS\_OWN; CREDIT\_COST\_RATE; UUID

Каждый LOAN в отдельной строке.
Идентификатор каждого отчета - GROUP\_ID из файлов.
Также добавить столбец с датой в формате DD.MM.YYYY из поля CREATE\_DATETIME
